import{u as _}from"./app-BkSPzRLz.js";import v from"./MenuItemVariationPopup-Dmfuly6t.js";import{d as C,r as S,o as i,b as o,e as a,a as y,g as c,t as m,F as r,h as u,f as h,c as N,n as k}from"./index-Br9qntu-.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as V}from"./forwardRefs-B4cOXIfo.js";import"./VDialog-CaCeG4bo.js";const $=C({name:"MenuPopup",components:{MenuItemVariationPopup:v},props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0}},emits:["update:modelValue","selected","close"],data(){return{menuName:this.title,itemList:[],pathHistory:[],selectedItem:null,isShowVariationPopup:!1}},computed:{appStore:()=>_(),menu:()=>_().menu,menuTitle(){return[...this.pathHistory,this.menuName].join(" > ")}},watch:{modelValue(e){e&&(this.menuName=this.title,this.itemList=this.menu[this.menuName])}},methods:{tapOnMenuItem(e){e.type==="folder"?(this.pathHistory.push(this.menuName),this.menuName=e.name,this.itemList=e.children):e.variations&&e.variations.length>0?(this.selectedItem=e,this.isShowVariationPopup=!0):(this.addItemToBill(e),this.$emit("selected",e))},onChanged(e){this.$emit("update:modelValue",e),e===!1&&(this.pathHistory=[],this.$emit("close"))},addItemToBill(e,s={}){const p=this.appStore.getClipboardNumber(1);if(p>0){const g=Object.keys(s).reduce((d,l)=>{const t=s[l];return d+t.price},0),f=Object.keys(s).reduce((d,l)=>{const t=s[l];return[...d,t.name]},[]);this.appStore.addItemToCurrentBill({name:e.name,price:e.price+g,qty:p,variation:f})}this.appStore.clearClipboard(),this.pathHistory=[],this.$emit("close")},goBack(){this.pathHistory.length>0?(this.menuName=this.pathHistory.pop(),this.itemList=this.menu[this.menuName]):this.onChanged(!1)},onVariationSelected(e){this.isShowVariationPopup=!1,this.addItemToBill(this.selectedItem,e)}}}),B={key:0,class:"dialog"},w={class:"dialog-title"},I={class:"dialog-title__text"},L={class:"dialog-title__actions"},M={class:"dialog-content-wrap"},H={key:0,class:"dialog-content"},T={class:"menu-folder"},O={class:"folder-name"},j={class:"menu-item-list"},q=["onClick"],F=["src","alt"],z={key:1,class:"menu-folder"},A={class:"menu-item-list"},D=["onClick"],E=["src","alt"];function U(e,s,p,g,f,d){const l=S("MenuItemVariationPopup");return e.modelValue?(i(),o("div",B,[a("div",w,[a("div",I,[y(V,{icon:"mdi-arrow-left",onClick:e.goBack},null,8,["onClick"]),c(" "+m(e.menuTitle),1)]),a("div",L,[y(V,{icon:"mdi-close",onClick:s[0]||(s[0]=t=>e.onChanged(!1))})])]),a("div",M,[e.itemList.length>0?(i(),o("div",H,[e.itemList[0].type==="folder"?(i(!0),o(r,{key:0},u(e.itemList,t=>(i(),o("div",T,[a("div",O,m(t.name),1),a("div",j,[(i(!0),o(r,null,u(t.children,n=>(i(),o("div",{class:k(["menu-item",{"with-image":n.image,"grid-item-extend-x":!n.image&&n.name.length>=20}]),onClick:b=>e.tapOnMenuItem(n)},[n.image?(i(),o("img",{key:0,src:n.image,alt:n.name},null,8,F)):(i(),o(r,{key:1},[c(m(n.name),1)],64))],10,q))),256))])]))),256)):(i(),o("div",z,[a("div",A,[(i(!0),o(r,null,u(e.itemList,t=>(i(),o("div",{class:k(["menu-item",{"with-image":t.image,"grid-item-extend-x":!t.image&&t.name.length>=20}]),onClick:n=>e.tapOnMenuItem(t)},[t.image?(i(),o("img",{key:0,src:t.image,alt:t.name},null,8,E)):(i(),o(r,{key:1},[c(m(t.name),1)],64))],10,D))),256))])]))])):h("",!0)]),e.selectedItem?(i(),N(l,{key:0,modelValue:e.isShowVariationPopup,"onUpdate:modelValue":s[1]||(s[1]=t=>e.isShowVariationPopup=t),"menu-item":e.selectedItem,onSelected:e.onVariationSelected},null,8,["modelValue","menu-item","onSelected"])):h("",!0)])):h("",!0)}const X=P($,[["render",U],["__scopeId","data-v-7068c92c"]]);export{X as default};
